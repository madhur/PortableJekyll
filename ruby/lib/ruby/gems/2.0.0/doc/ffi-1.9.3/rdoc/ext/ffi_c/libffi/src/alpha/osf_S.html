<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>osf.S - ffi-1.9.3 Documentation</title>

<link type="text/css" media="screen" href="../../../../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../../../";
</script>

<script type="text/javascript" charset="utf-8" src="../../../../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../../../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../../../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../../../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../../../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../../../js/darkfish.js"></script>


<body class="file">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../../../../../index.html">Home</a>
    <a href="../../../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../../../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../../../../../ext/ffi_c/Makefile.html">Makefile</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/ffi_c-i386-mingw32_def.html">ffi_c-i386-mingw32.def</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/Makefile.html">Makefile</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/config_log.html">config.log</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/config_status.html">config.status</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/include/Makefile.html">Makefile</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/libffi_la.html">libffi.la</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/libffi_pc.html">libffi.pc</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/libffi_convenience_la.html">libffi_convenience.la</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/libtool.html">libtool</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/man/Makefile.html">Makefile</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/closures_lo.html">closures.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/debug_lo.html">debug.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/java_raw_api_lo.html">java_raw_api.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/prep_cif_lo.html">prep_cif.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/raw_api_lo.html">raw_api.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/types_lo.html">types.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/x86/ffi_lo.html">ffi.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/x86/win32_lo.html">win32.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/stamp-h1.html">stamp-h1</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/testsuite/Makefile.html">Makefile</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/ChangeLog.html">ChangeLog</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/ChangeLog_libffi.html">ChangeLog.libffi</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/ChangeLog_libgcj.html">ChangeLog.libgcj</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/ChangeLog_v1.html">ChangeLog.v1</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/LICENSE.html">LICENSE</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/Makefile_am.html">Makefile.am</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/Makefile_in.html">Makefile.in</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/Makefile_vc.html">Makefile.vc</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/Makefile_vc64.html">Makefile.vc64</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/README.html">README</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/acinclude_m4.html">acinclude.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/build-ios_sh.html">build-ios.sh</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/compile.html">compile</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/config_guess.html">config.guess</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/config_sub.html">config.sub</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/configure.html">configure</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/configure_ac.html">configure.ac</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/configure_host.html">configure.host</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/depcomp.html">depcomp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/doc/libffi_info.html">libffi.info</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/doc/stamp-vti.html">stamp-vti</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/doc/version_texi.html">version.texi</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/fficonfig_h_in.html">fficonfig.h.in</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/include/Makefile_am.html">Makefile.am</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/include/Makefile_in.html">Makefile.in</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/install-sh.html">install-sh</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/libffi_pc_in.html">libffi.pc.in</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/libtool-version.html">libtool-version</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/ltmain_sh.html">ltmain.sh</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_cc_maxopt_m4.html">ax_cc_maxopt.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_cflags_warn_all_m4.html">ax_cflags_warn_all.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_check_compiler_flags_m4.html">ax_check_compiler_flags.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_compiler_vendor_m4.html">ax_compiler_vendor.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_configure_args_m4.html">ax_configure_args.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_enable_builddir_m4.html">ax_enable_builddir.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_gcc_archflag_m4.html">ax_gcc_archflag.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_gcc_x86_cpuid_m4.html">ax_gcc_x86_cpuid.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/man/Makefile_am.html">Makefile.am</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/man/Makefile_in.html">Makefile.in</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/man/ffi_3.html">ffi.3</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/man/ffi_call_3.html">ffi_call.3</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/man/ffi_prep_cif_3.html">ffi_prep_cif.3</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/mdate-sh.html">mdate-sh</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/missing.html">missing</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/msvcc_sh.html">msvcc.sh</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/alpha/osf_S.html">osf.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/arm/gentramp_sh.html">gentramp.sh</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/arm/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/arm/trampoline_S.html">trampoline.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/avr32/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/cris/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/frv/eabi_S.html">eabi.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/ia64/unix_S.html">unix.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/m32r/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/m68k/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/mips/n32_S.html">n32.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/mips/o32_S.html">o32.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/moxie/eabi_S.html">eabi.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/pa/hpux32_S.html">hpux32.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/pa/linux_S.html">linux.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/aix_S.html">aix.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/aix_closure_S.html">aix_closure.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/darwin_S.html">darwin.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/darwin_closure_S.html">darwin_closure.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/linux64_S.html">linux64.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/linux64_closure_S.html">linux64_closure.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/ppc_closure_S.html">ppc_closure.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/s390/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/sh/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/sh64/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/sparc/v8_S.html">v8.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/sparc/v9_S.html">v9.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/darwin_S.html">darwin.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/darwin64_S.html">darwin64.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/freebsd_S.html">freebsd.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/unix64_S.html">unix64.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/win32_S.html">win32.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/win64_S.html">win64.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/Makefile_am.html">Makefile.am</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/Makefile_in.html">Makefile.in</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/config/default_exp.html">default.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/lib/libffi-dg_exp.html">libffi-dg.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/lib/libffi_exp.html">libffi.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/lib/target-libpath_exp.html">target-libpath.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/lib/wrapper_exp.html">wrapper.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/libffi_call/call_exp.html">call.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/libffi_special/special_exp.html">special.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/texinfo_tex.html">texinfo.tex</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/mkmf_log.html">mkmf.log</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/arm-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-cygwin/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-darwin/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-freebsd/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-gnu/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-netbsd/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-openbsd/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-solaris/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-windows/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/ia64-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/mips-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/mipsel-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/powerpc-aix/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/powerpc-darwin/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/powerpc-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/s390-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/s390x-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/sparc-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/sparc-solaris/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/sparcv9-solaris/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-cygwin/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-darwin/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-freebsd/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-netbsd/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-openbsd/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-solaris/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-windows/types_conf.html">types.conf</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../../../../../FFI.html">FFI</a>
  
    <li><a href="../../../../../FFI/AutoPointer.html">FFI::AutoPointer</a>
  
    <li><a href="../../../../../FFI/AutoPointer/CallableReleaser.html">FFI::AutoPointer::CallableReleaser</a>
  
    <li><a href="../../../../../FFI/AutoPointer/DefaultReleaser.html">FFI::AutoPointer::DefaultReleaser</a>
  
    <li><a href="../../../../../FFI/AutoPointer/Releaser.html">FFI::AutoPointer::Releaser</a>
  
    <li><a href="../../../../../FFI/ConstGenerator.html">FFI::ConstGenerator</a>
  
    <li><a href="../../../../../FFI/ConstGenerator/Constant.html">FFI::ConstGenerator::Constant</a>
  
    <li><a href="../../../../../FFI/Enum.html">FFI::Enum</a>
  
    <li><a href="../../../../../FFI/Enums.html">FFI::Enums</a>
  
    <li><a href="../../../../../FFI/Generator.html">FFI::Generator</a>
  
    <li><a href="../../../../../FFI/Generator/Task.html">FFI::Generator::Task</a>
  
    <li><a href="../../../../../FFI/IO.html">FFI::IO</a>
  
    <li><a href="../../../../../FFI/Library.html">FFI::Library</a>
  
    <li><a href="../../../../../FFI/ManagedStruct.html">FFI::ManagedStruct</a>
  
    <li><a href="../../../../../FFI/NotFoundError.html">FFI::NotFoundError</a>
  
    <li><a href="../../../../../FFI/Platform.html">FFI::Platform</a>
  
    <li><a href="../../../../../FFI/PlatformError.html">FFI::PlatformError</a>
  
    <li><a href="../../../../../FFI/Pointer.html">FFI::Pointer</a>
  
    <li><a href="../../../../../FFI/StrPtrConverter.html">FFI::StrPtrConverter</a>
  
    <li><a href="../../../../../FFI/Struct.html">FFI::Struct</a>
  
    <li><a href="../../../../../FFI/Struct/ManagedStructConverter.html">FFI::Struct::ManagedStructConverter</a>
  
    <li><a href="../../../../../FFI/StructGenerator.html">FFI::StructGenerator</a>
  
    <li><a href="../../../../../FFI/StructGenerator/Field.html">FFI::StructGenerator::Field</a>
  
    <li><a href="../../../../../FFI/StructLayout.html">FFI::StructLayout</a>
  
    <li><a href="../../../../../FFI/StructLayout/Enum.html">FFI::StructLayout::Enum</a>
  
    <li><a href="../../../../../FFI/StructLayout/InnerStruct.html">FFI::StructLayout::InnerStruct</a>
  
    <li><a href="../../../../../FFI/StructLayout/Mapped.html">FFI::StructLayout::Mapped</a>
  
    <li><a href="../../../../../FFI/StructLayoutBuilder.html">FFI::StructLayoutBuilder</a>
  
    <li><a href="../../../../../FFI/Type.html">FFI::Type</a>
  
    <li><a href="../../../../../FFI/TypesGenerator.html">FFI::TypesGenerator</a>
  
    <li><a href="../../../../../FFI/Union.html">FFI::Union</a>
  
    <li><a href="../../../../../FFI/VariadicInvoker.html">FFI::VariadicInvoker</a>
  
    <li><a href="../../../../../RbConfig.html">RbConfig</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation" class="description">
  
<pre>-----------------------------------------------------------------------
osf.S - Copyright (c) 1998, 2001, 2007, 2008, 2011 Red Hat

Alpha/OSF Foreign Function Interface 

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
``Software&#39;&#39;), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED ``AS IS&#39;&#39;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT.  IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.
-----------------------------------------------------------------------</pre>

<p>define LIBFFI_ASM</p>

<p>include &lt;fficonfig.h&gt; include &lt;ffi.h&gt;</p>

<pre>     .arch ev6
     .text

ffi_call_osf (void *args, unsigned long bytes, unsigned flags,
              void *raddr, void (*fnaddr)(void));

Bit o trickiness here -- ARGS+BYTES is the base of the stack frame
for this function.  This has been allocated by ffi_call.  We also
deallocate some of the stack that has been alloca&#39;d.    

     .align  3
     .globl  ffi_call_osf
     .ent    ffi_call_osf
     FFI_HIDDEN(ffi_call_osf)</pre>

<p>ffi_call_osf:</p>

<pre>.frame  $15, 32, $26, 0
.mask   0x4008000, -32</pre>

<p>$LFB1:</p>

<pre>addq    $16,$17,$1
mov     $16, $30
stq     $26, 0($1)
stq     $15, 8($1)
stq     $18, 16($1)
mov     $1, $15</pre>

<p>$LCFI1:</p>

<pre>.prologue 0

stq     $19, 24($1)
mov     $20, $27

# Load up all of the (potential) argument registers.
ldq     $16, 0($30)
ldt     $f16, 0($30)
ldt     $f17, 8($30)
ldq     $17, 8($30)
ldt     $f18, 16($30)
ldq     $18, 16($30)
ldt     $f19, 24($30)
ldq     $19, 24($30)
ldt     $f20, 32($30)
ldq     $20, 32($30)
ldt     $f21, 40($30)
ldq     $21, 40($30)

# Deallocate the register argument area.
lda     $30, 48($30)

jsr     $26, ($27), 0
ldgp    $29, 0($26)

# If the return value pointer is NULL, assume no return value.
ldq     $19, 24($15)
ldq     $18, 16($15)
ldq     $26, 0($15)</pre>

<p>$LCFI2:</p>

<pre>beq     $19, $noretval

# Store the return value out in the proper type.
cmpeq   $18, FFI_TYPE_INT, $1
bne     $1, $retint
cmpeq   $18, FFI_TYPE_FLOAT, $2
bne     $2, $retfloat
cmpeq   $18, FFI_TYPE_DOUBLE, $3
bne     $3, $retdouble

.align  3</pre>

<p>$noretval:</p>

<pre>ldq     $15, 8($15)
ret

.align  4</pre>

<p>$retint:</p>

<pre>stq     $0, 0($19)
nop
ldq     $15, 8($15)
ret

.align  4</pre>

<p>$retfloat:</p>

<pre>sts     $f0, 0($19)
nop
ldq     $15, 8($15)
ret

.align  4</pre>

<p>$retdouble:</p>

<pre>stt     $f0, 0($19)
nop
ldq     $15, 8($15)
ret</pre>

<p>$LFE1:</p>

<pre>.end    ffi_call_osf</pre>

<p>/* ffi_closure_osf(…)</p>

<pre>Receives the closure argument in $1.   */

     .align  3
     .globl  ffi_closure_osf
     .ent    ffi_closure_osf
     FFI_HIDDEN(ffi_closure_osf)</pre>

<p>ffi_closure_osf:</p>

<pre>.frame  $30, 16*8, $26, 0
.mask   0x4000000, -16*8</pre>

<p>$LFB2:</p>

<pre>ldgp    $29, 0($27)
subq    $30, 16*8, $30</pre>

<p>$LCFI5:</p>

<pre>stq     $26, 0($30)</pre>

<p>$LCFI6:</p>

<pre>.prologue 1

# Store all of the potential argument registers in va_list format.
stt     $f16, 4*8($30)
stt     $f17, 5*8($30)
stt     $f18, 6*8($30)
stt     $f19, 7*8($30)
stt     $f20, 8*8($30)
stt     $f21, 9*8($30)
stq     $16, 10*8($30)
stq     $17, 11*8($30)
stq     $18, 12*8($30)
stq     $19, 13*8($30)
stq     $20, 14*8($30)
stq     $21, 15*8($30)

# Call ffi_closure_osf_inner to do the bulk of the work.
mov     $1, $16
lda     $17, 2*8($30)
lda     $18, 10*8($30)
jsr     $26, ffi_closure_osf_inner
ldgp    $29, 0($26)
ldq     $26, 0($30)

# Load up the return value in the proper type.
lda     $1, $load_table
s4addq  $0, $1, $1
ldl     $1, 0($1)
addq    $1, $29, $1
jmp     $31, ($1), $load_32

.align 4</pre>

<p>$load_none:</p>

<pre>addq    $30, 16*8, $30
ret

.align 4</pre>

<p>$load_float:</p>

<pre>lds     $f0, 16($30)
nop
addq    $30, 16*8, $30
ret

.align 4</pre>

<p>$load_double:</p>

<pre>ldt     $f0, 16($30)
nop
addq    $30, 16*8, $30
ret

.align 4</pre>

<p>$load_u8: ifdef <em>alpha_bwx</em></p>

<pre>ldbu    $0, 16($30)
nop</pre>

<p>else</p>

<pre>ldq     $0, 16($30)
and     $0, 255, $0</pre>

<p>endif</p>

<pre>addq    $30, 16*8, $30
ret

.align 4</pre>

<p>$load_s8: ifdef <em>alpha_bwx</em></p>

<pre>ldbu    $0, 16($30)
sextb   $0, $0</pre>

<p>else</p>

<pre>ldq     $0, 16($30)
sll     $0, 56, $0
sra     $0, 56, $0</pre>

<p>endif</p>

<pre>addq    $30, 16*8, $30
ret

.align 4</pre>

<p>$load_u16: ifdef <em>alpha_bwx</em></p>

<pre>ldwu    $0, 16($30)
nop</pre>

<p>else</p>

<pre>ldq     $0, 16($30)
zapnot  $0, 3, $0</pre>

<p>endif</p>

<pre>addq    $30, 16*8, $30
ret

.align 4</pre>

<p>$load_s16: ifdef <em>alpha_bwx</em></p>

<pre>ldwu    $0, 16($30)
sextw   $0, $0</pre>

<p>else</p>

<pre>ldq     $0, 16($30)
sll     $0, 48, $0
sra     $0, 48, $0</pre>

<p>endif</p>

<pre>addq    $30, 16*8, $30
ret

.align 4</pre>

<p>$load_32:</p>

<pre>ldl     $0, 16($30)
nop
addq    $30, 16*8, $30
ret

.align 4</pre>

<p>$load_64:</p>

<pre>ldq     $0, 16($30)
nop
addq    $30, 16*8, $30
ret</pre>

<p>$LFE2:</p>

<pre>.end    ffi_closure_osf</pre>

<p>ifdef __ELF__ .section .rodata else .rdata endif $load_table:</p>

<pre>.gprel32 $load_none     # FFI_TYPE_VOID
.gprel32 $load_32       # FFI_TYPE_INT
.gprel32 $load_float    # FFI_TYPE_FLOAT
.gprel32 $load_double   # FFI_TYPE_DOUBLE
.gprel32 $load_none     # FFI_TYPE_LONGDOUBLE
.gprel32 $load_u8       # FFI_TYPE_UINT8
.gprel32 $load_s8       # FFI_TYPE_SINT8
.gprel32 $load_u16      # FFI_TYPE_UINT16
.gprel32 $load_s16      # FFI_TYPE_SINT16
.gprel32 $load_32       # FFI_TYPE_UINT32
.gprel32 $load_32       # FFI_TYPE_SINT32
.gprel32 $load_64       # FFI_TYPE_UINT64
.gprel32 $load_64       # FFI_TYPE_SINT64
.gprel32 $load_none     # FFI_TYPE_STRUCT
.gprel32 $load_64       # FFI_TYPE_POINTER</pre>

<p>/* Assert that the table above is in sync with ffi.h.  */</p>

<p>if        FFI_TYPE_FLOAT != 2          \</p>

<pre>|| FFI_TYPE_DOUBLE != 3         \
|| FFI_TYPE_UINT8 != 5          \
|| FFI_TYPE_SINT8 != 6          \
|| FFI_TYPE_UINT16 != 7         \
|| FFI_TYPE_SINT16 != 8         \
|| FFI_TYPE_UINT32 != 9         \
|| FFI_TYPE_SINT32 != 10        \
|| FFI_TYPE_UINT64 != 11        \
|| FFI_TYPE_SINT64 != 12        \
|| FFI_TYPE_STRUCT != 13        \
|| FFI_TYPE_POINTER != 14       \
|| FFI_TYPE_LAST != 14</pre>

<p>error “osf.S out of sync with ffi.h” endif</p>

<p>ifdef __ELF__ # define UA_SI          .4byte # define FDE_ENCODING   0x1b  
/* pcrel sdata4 */ # define FDE_ENCODE(X)  .4byte X-. # define
FDE_ARANGE(X)  .4byte X elif defined __osf__ # define UA_SI          .align
0; .long # define FDE_ENCODING   0x50    /* aligned absolute */ # define
FDE_ENCODE(X)  .align 3; .quad X # define FDE_ARANGE(X)  .align 0; .quad X
endif</p>

<p>ifdef __ELF__</p>

<pre>.section        .eh_frame,EH_FRAME_FLAGS,@progbits</pre>

<p>elif defined __osf__</p>

<pre>.data
.align 3
.globl _GLOBAL__F_ffi_call_osf</pre>

<p>_GLOBAL__F_ffi_call_osf: endif <em>FRAME_BEGIN</em>:</p>

<pre>UA_SI   $LECIE1-$LSCIE1 # Length of Common Information Entry</pre>

<p>$LSCIE1:</p>

<pre>UA_SI   0x0             # CIE Identifier Tag
.byte   0x1             # CIE Version
.ascii &quot;zR\0&quot;           # CIE Augmentation
.byte   0x1             # uleb128 0x1; CIE Code Alignment Factor
.byte   0x78            # sleb128 -8; CIE Data Alignment Factor
.byte   26              # CIE RA Column
.byte   0x1             # uleb128 0x1; Augmentation size
.byte   FDE_ENCODING    # FDE Encoding
.byte   0xc             # DW_CFA_def_cfa
.byte   30              # uleb128 column 30
.byte   0               # uleb128 offset 0
.align 3</pre>

<p>$LECIE1: $LSFDE1:</p>

<pre>UA_SI   $LEFDE1-$LASFDE1                # FDE Length</pre>

<p>$LASFDE1:</p>

<pre>UA_SI   $LASFDE1-__FRAME_BEGIN__        # FDE CIE offset
FDE_ENCODE($LFB1)                       # FDE initial location
FDE_ARANGE($LFE1-$LFB1)                 # FDE address range
.byte   0x0             # uleb128 0x0; Augmentation size

.byte   0x4             # DW_CFA_advance_loc4
UA_SI   $LCFI1-$LFB1
.byte   0x9a            # DW_CFA_offset, column 26
.byte   4               # uleb128 4*-8
.byte   0x8f            # DW_CFA_offset, column 15
.byte   0x3             # uleb128 3*-8
.byte   0xc             # DW_CFA_def_cfa
.byte   15              # uleb128 column 15
.byte   32              # uleb128 offset 32

.byte   0x4             # DW_CFA_advance_loc4
UA_SI   $LCFI2-$LCFI1
.byte   0xda            # DW_CFA_restore, column 26
.align 3</pre>

<p>$LEFDE1:</p>

<p>$LSFDE3:</p>

<pre>UA_SI   $LEFDE3-$LASFDE3                # FDE Length</pre>

<p>$LASFDE3:</p>

<pre>UA_SI   $LASFDE3-__FRAME_BEGIN__        # FDE CIE offset
FDE_ENCODE($LFB2)                       # FDE initial location
FDE_ARANGE($LFE2-$LFB2)                 # FDE address range
.byte   0x0             # uleb128 0x0; Augmentation size

.byte   0x4             # DW_CFA_advance_loc4
UA_SI   $LCFI5-$LFB2
.byte   0xe             # DW_CFA_def_cfa_offset
.byte   0x80,0x1        # uleb128 128

.byte   0x4             # DW_CFA_advance_loc4
UA_SI   $LCFI6-$LCFI5
.byte   0x9a            # DW_CFA_offset, column 26
.byte   16              # uleb128 offset 16*-8
.align 3</pre>

<p>$LEFDE3: if defined __osf__</p>

<pre>.align 0
.long   0               # End of Table</pre>

<p>endif</p>

<p>if defined __ELF__ &amp;&amp; defined __linux__</p>

<pre>.section        .note.GNU-stack,&quot;&quot;,@progbits</pre>

<p>endif</p>

</div>



<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 4.0.0.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

