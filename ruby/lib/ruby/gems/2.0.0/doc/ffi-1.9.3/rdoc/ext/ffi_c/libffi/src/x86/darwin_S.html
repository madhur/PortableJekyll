<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>darwin.S - ffi-1.9.3 Documentation</title>

<link type="text/css" media="screen" href="../../../../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../../../";
</script>

<script type="text/javascript" charset="utf-8" src="../../../../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../../../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../../../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../../../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../../../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../../../js/darkfish.js"></script>


<body class="file">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../../../../../index.html">Home</a>
    <a href="../../../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../../../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../../../../../ext/ffi_c/Makefile.html">Makefile</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/ffi_c-i386-mingw32_def.html">ffi_c-i386-mingw32.def</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/Makefile.html">Makefile</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/config_log.html">config.log</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/config_status.html">config.status</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/include/Makefile.html">Makefile</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/libffi_la.html">libffi.la</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/libffi_pc.html">libffi.pc</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/libffi_convenience_la.html">libffi_convenience.la</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/libtool.html">libtool</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/man/Makefile.html">Makefile</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/closures_lo.html">closures.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/debug_lo.html">debug.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/java_raw_api_lo.html">java_raw_api.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/prep_cif_lo.html">prep_cif.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/raw_api_lo.html">raw_api.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/types_lo.html">types.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/x86/ffi_lo.html">ffi.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/src/x86/win32_lo.html">win32.lo</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/stamp-h1.html">stamp-h1</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi-i386-mingw32/testsuite/Makefile.html">Makefile</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/ChangeLog.html">ChangeLog</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/ChangeLog_libffi.html">ChangeLog.libffi</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/ChangeLog_libgcj.html">ChangeLog.libgcj</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/ChangeLog_v1.html">ChangeLog.v1</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/LICENSE.html">LICENSE</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/Makefile_am.html">Makefile.am</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/Makefile_in.html">Makefile.in</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/Makefile_vc.html">Makefile.vc</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/Makefile_vc64.html">Makefile.vc64</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/README.html">README</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/acinclude_m4.html">acinclude.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/build-ios_sh.html">build-ios.sh</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/compile.html">compile</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/config_guess.html">config.guess</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/config_sub.html">config.sub</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/configure.html">configure</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/configure_ac.html">configure.ac</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/configure_host.html">configure.host</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/depcomp.html">depcomp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/doc/libffi_info.html">libffi.info</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/doc/stamp-vti.html">stamp-vti</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/doc/version_texi.html">version.texi</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/fficonfig_h_in.html">fficonfig.h.in</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/include/Makefile_am.html">Makefile.am</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/include/Makefile_in.html">Makefile.in</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/install-sh.html">install-sh</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/libffi_pc_in.html">libffi.pc.in</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/libtool-version.html">libtool-version</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/ltmain_sh.html">ltmain.sh</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_cc_maxopt_m4.html">ax_cc_maxopt.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_cflags_warn_all_m4.html">ax_cflags_warn_all.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_check_compiler_flags_m4.html">ax_check_compiler_flags.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_compiler_vendor_m4.html">ax_compiler_vendor.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_configure_args_m4.html">ax_configure_args.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_enable_builddir_m4.html">ax_enable_builddir.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_gcc_archflag_m4.html">ax_gcc_archflag.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/m4/ax_gcc_x86_cpuid_m4.html">ax_gcc_x86_cpuid.m4</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/man/Makefile_am.html">Makefile.am</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/man/Makefile_in.html">Makefile.in</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/man/ffi_3.html">ffi.3</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/man/ffi_call_3.html">ffi_call.3</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/man/ffi_prep_cif_3.html">ffi_prep_cif.3</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/mdate-sh.html">mdate-sh</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/missing.html">missing</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/msvcc_sh.html">msvcc.sh</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/alpha/osf_S.html">osf.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/arm/gentramp_sh.html">gentramp.sh</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/arm/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/arm/trampoline_S.html">trampoline.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/avr32/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/cris/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/frv/eabi_S.html">eabi.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/ia64/unix_S.html">unix.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/m32r/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/m68k/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/mips/n32_S.html">n32.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/mips/o32_S.html">o32.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/moxie/eabi_S.html">eabi.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/pa/hpux32_S.html">hpux32.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/pa/linux_S.html">linux.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/aix_S.html">aix.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/aix_closure_S.html">aix_closure.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/darwin_S.html">darwin.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/darwin_closure_S.html">darwin_closure.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/linux64_S.html">linux64.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/linux64_closure_S.html">linux64_closure.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/ppc_closure_S.html">ppc_closure.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/powerpc/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/s390/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/sh/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/sh64/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/sparc/v8_S.html">v8.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/sparc/v9_S.html">v9.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/darwin_S.html">darwin.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/darwin64_S.html">darwin64.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/freebsd_S.html">freebsd.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/sysv_S.html">sysv.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/unix64_S.html">unix64.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/win32_S.html">win32.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/src/x86/win64_S.html">win64.S</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/Makefile_am.html">Makefile.am</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/Makefile_in.html">Makefile.in</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/config/default_exp.html">default.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/lib/libffi-dg_exp.html">libffi-dg.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/lib/libffi_exp.html">libffi.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/lib/target-libpath_exp.html">target-libpath.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/lib/wrapper_exp.html">wrapper.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/libffi_call/call_exp.html">call.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/testsuite/libffi_special/special_exp.html">special.exp</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/libffi/texinfo_tex.html">texinfo.tex</a>
  
    <li class="file"><a href="../../../../../ext/ffi_c/mkmf_log.html">mkmf.log</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/arm-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-cygwin/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-darwin/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-freebsd/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-gnu/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-netbsd/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-openbsd/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-solaris/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/i386-windows/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/ia64-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/mips-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/mipsel-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/powerpc-aix/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/powerpc-darwin/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/powerpc-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/s390-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/s390x-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/sparc-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/sparc-solaris/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/sparcv9-solaris/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-cygwin/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-darwin/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-freebsd/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-linux/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-netbsd/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-openbsd/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-solaris/types_conf.html">types.conf</a>
  
    <li class="file"><a href="../../../../../lib/ffi/platform/x86_64-windows/types_conf.html">types.conf</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../../../../../FFI.html">FFI</a>
  
    <li><a href="../../../../../FFI/AutoPointer.html">FFI::AutoPointer</a>
  
    <li><a href="../../../../../FFI/AutoPointer/CallableReleaser.html">FFI::AutoPointer::CallableReleaser</a>
  
    <li><a href="../../../../../FFI/AutoPointer/DefaultReleaser.html">FFI::AutoPointer::DefaultReleaser</a>
  
    <li><a href="../../../../../FFI/AutoPointer/Releaser.html">FFI::AutoPointer::Releaser</a>
  
    <li><a href="../../../../../FFI/ConstGenerator.html">FFI::ConstGenerator</a>
  
    <li><a href="../../../../../FFI/ConstGenerator/Constant.html">FFI::ConstGenerator::Constant</a>
  
    <li><a href="../../../../../FFI/Enum.html">FFI::Enum</a>
  
    <li><a href="../../../../../FFI/Enums.html">FFI::Enums</a>
  
    <li><a href="../../../../../FFI/Generator.html">FFI::Generator</a>
  
    <li><a href="../../../../../FFI/Generator/Task.html">FFI::Generator::Task</a>
  
    <li><a href="../../../../../FFI/IO.html">FFI::IO</a>
  
    <li><a href="../../../../../FFI/Library.html">FFI::Library</a>
  
    <li><a href="../../../../../FFI/ManagedStruct.html">FFI::ManagedStruct</a>
  
    <li><a href="../../../../../FFI/NotFoundError.html">FFI::NotFoundError</a>
  
    <li><a href="../../../../../FFI/Platform.html">FFI::Platform</a>
  
    <li><a href="../../../../../FFI/PlatformError.html">FFI::PlatformError</a>
  
    <li><a href="../../../../../FFI/Pointer.html">FFI::Pointer</a>
  
    <li><a href="../../../../../FFI/StrPtrConverter.html">FFI::StrPtrConverter</a>
  
    <li><a href="../../../../../FFI/Struct.html">FFI::Struct</a>
  
    <li><a href="../../../../../FFI/Struct/ManagedStructConverter.html">FFI::Struct::ManagedStructConverter</a>
  
    <li><a href="../../../../../FFI/StructGenerator.html">FFI::StructGenerator</a>
  
    <li><a href="../../../../../FFI/StructGenerator/Field.html">FFI::StructGenerator::Field</a>
  
    <li><a href="../../../../../FFI/StructLayout.html">FFI::StructLayout</a>
  
    <li><a href="../../../../../FFI/StructLayout/Enum.html">FFI::StructLayout::Enum</a>
  
    <li><a href="../../../../../FFI/StructLayout/InnerStruct.html">FFI::StructLayout::InnerStruct</a>
  
    <li><a href="../../../../../FFI/StructLayout/Mapped.html">FFI::StructLayout::Mapped</a>
  
    <li><a href="../../../../../FFI/StructLayoutBuilder.html">FFI::StructLayoutBuilder</a>
  
    <li><a href="../../../../../FFI/Type.html">FFI::Type</a>
  
    <li><a href="../../../../../FFI/TypesGenerator.html">FFI::TypesGenerator</a>
  
    <li><a href="../../../../../FFI/Union.html">FFI::Union</a>
  
    <li><a href="../../../../../FFI/VariadicInvoker.html">FFI::VariadicInvoker</a>
  
    <li><a href="../../../../../RbConfig.html">RbConfig</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation" class="description">
  
<pre>-----------------------------------------------------------------------
darwin.S - Copyright (c) 1996, 1998, 2001, 2002, 2003, 2005  Red Hat, Inc.
     Copyright (C) 2008  Free Software Foundation, Inc.

X86 Foreign Function Interface

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
``Software&#39;&#39;), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED ``AS IS&#39;&#39;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT.  IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.
-----------------------------------------------------------------------</pre>

<p>ifndef <em>x86_64</em></p>

<p>define LIBFFI_ASM</p>

<p>include &lt;fficonfig.h&gt; include &lt;ffi.h&gt;</p>

<p>.text</p>

<p>.globl _ffi_prep_args</p>

<pre>.align 4</pre>

<p>.globl _ffi_call_SYSV</p>

<p>_ffi_call_SYSV: .LFB1:</p>

<pre>pushl %ebp</pre>

<p>.LCFI0:</p>

<pre>movl  %esp,%ebp</pre>

<p>.LCFI1:</p>

<pre>subl $8,%esp
   Make room for all of the new args.    
movl  16(%ebp),%ecx
subl  %ecx,%esp

movl  %esp,%eax

/* Place all of the ffi_prep_args in position  */
subl  $8,%esp
pushl 12(%ebp)
pushl %eax
call  *8(%ebp)

/* Return stack to previous state and call the function  */
addl  $16,%esp  

call  *28(%ebp)

/* Load %ecx with the return type code  */
movl  20(%ebp),%ecx     

/* Protect %esi.  We&#39;re going to pop it in the epilogue.  */
pushl %esi

/* If the return value pointer is NULL, assume no return value.  */
cmpl  $0,24(%ebp)
jne  0f

/* Even if there is no space for the return value, we are 
   obliged to handle floating-point values.  */
cmpl  $FFI_TYPE_FLOAT,%ecx
jne   noretval
fstp  %st(0)

jmp   epilogue</pre>

<p>0:</p>

<pre>.align 4
call 1f</pre>

<p>.Lstore_table:</p>

<pre>.long   noretval-.Lstore_table          /* FFI_TYPE_VOID */
.long   retint-.Lstore_table            /* FFI_TYPE_INT */
.long   retfloat-.Lstore_table          /* FFI_TYPE_FLOAT */
.long   retdouble-.Lstore_table         /* FFI_TYPE_DOUBLE */
.long   retlongdouble-.Lstore_table     /* FFI_TYPE_LONGDOUBLE */
.long   retuint8-.Lstore_table          /* FFI_TYPE_UINT8 */
.long   retsint8-.Lstore_table          /* FFI_TYPE_SINT8 */
.long   retuint16-.Lstore_table         /* FFI_TYPE_UINT16 */
.long   retsint16-.Lstore_table         /* FFI_TYPE_SINT16 */
.long   retint-.Lstore_table            /* FFI_TYPE_UINT32 */
.long   retint-.Lstore_table            /* FFI_TYPE_SINT32 */
.long   retint64-.Lstore_table          /* FFI_TYPE_UINT64 */
.long   retint64-.Lstore_table          /* FFI_TYPE_SINT64 */
.long   retstruct-.Lstore_table         /* FFI_TYPE_STRUCT */
.long   retint-.Lstore_table            /* FFI_TYPE_POINTER */
.long   retstruct1b-.Lstore_table       /* FFI_TYPE_SMALL_STRUCT_1B */
.long   retstruct2b-.Lstore_table       /* FFI_TYPE_SMALL_STRUCT_2B */</pre>

<p>1:</p>

<pre>pop  %esi
add  (%esi, %ecx, 4), %esi
jmp  *%esi

/* Sign/zero extend as appropriate.  */</pre>

<p>retsint8:</p>

<pre>movsbl  %al, %eax
jmp  retint</pre>

<p>retsint16:</p>

<pre>movswl  %ax, %eax
jmp  retint</pre>

<p>retuint8:</p>

<pre>movzbl  %al, %eax
jmp  retint</pre>

<p>retuint16:</p>

<pre>movzwl  %ax, %eax
jmp  retint</pre>

<p>retfloat:</p>

<pre>/* Load %ecx with the pointer to storage for the return value  */
movl  24(%ebp),%ecx
fstps (%ecx)
jmp   epilogue</pre>

<p>retdouble:</p>

<pre>/* Load %ecx with the pointer to storage for the return value  */
movl  24(%ebp),%ecx
fstpl (%ecx)
jmp   epilogue</pre>

<p>retlongdouble:</p>

<pre>/* Load %ecx with the pointer to storage for the return value  */
movl  24(%ebp),%ecx
fstpt (%ecx)
jmp   epilogue</pre>

<p>retint64:</p>

<pre>/* Load %ecx with the pointer to storage for the return value  */
movl  24(%ebp),%ecx
movl  %eax,0(%ecx)
movl  %edx,4(%ecx)
jmp   epilogue</pre>

<p>retstruct1b:</p>

<pre>/* Load %ecx with the pointer to storage for the return value  */
movl  24(%ebp),%ecx
movb  %al,0(%ecx)
jmp   epilogue</pre>

<p>retstruct2b:</p>

<pre>/* Load %ecx with the pointer to storage for the return value  */
movl  24(%ebp),%ecx
movw  %ax,0(%ecx)
jmp   epilogue</pre>

<p>retint:</p>

<pre>/* Load %ecx with the pointer to storage for the return value  */
movl  24(%ebp),%ecx
movl  %eax,0(%ecx)</pre>

<p>retstruct:</p>

<pre>/* Nothing to do!  */</pre>

<p>noretval: epilogue:</p>

<pre>popl %esi
movl %ebp,%esp
popl %ebp
ret</pre>

<p>.LFE1: .ffi_call_SYSV_end:</p>

<pre>.align  4</pre>

<p>FFI_HIDDEN (ffi_closure_SYSV) .globl _ffi_closure_SYSV</p>

<p>_ffi_closure_SYSV: .LFB2:</p>

<pre>pushl   %ebp</pre>

<p>.LCFI2:</p>

<pre>movl    %esp, %ebp</pre>

<p>.LCFI3:</p>

<pre>subl    $40, %esp
leal    -24(%ebp), %edx
movl    %edx, -12(%ebp) /* resp */
leal    8(%ebp), %edx
movl    %edx, 4(%esp)   /* args = __builtin_dwarf_cfa () */
leal    -12(%ebp), %edx
movl    %edx, (%esp)    /* &amp;resp */
movl    %ebx, 8(%esp)</pre>

<p>.LCFI7:</p>

<pre>call    L_ffi_closure_SYSV_inner$stub
movl    8(%esp), %ebx
movl    -12(%ebp), %ecx
cmpl    $FFI_TYPE_INT, %eax
je      .Lcls_retint

/* Handle FFI_TYPE_UINT8, FFI_TYPE_SINT8, FFI_TYPE_UINT16,
   FFI_TYPE_SINT16, FFI_TYPE_UINT32, FFI_TYPE_SINT32.  */
cmpl    $FFI_TYPE_UINT64, %eax
jge     0f
cmpl    $FFI_TYPE_UINT8, %eax
jge     .Lcls_retint</pre>

<p>0:      cmpl    $FFI_TYPE_FLOAT, %eax</p>

<pre>je      .Lcls_retfloat
cmpl    $FFI_TYPE_DOUBLE, %eax
je      .Lcls_retdouble
cmpl    $FFI_TYPE_LONGDOUBLE, %eax
je      .Lcls_retldouble
cmpl    $FFI_TYPE_SINT64, %eax
je      .Lcls_retllong
cmpl    $FFI_TYPE_SMALL_STRUCT_1B, %eax
je      .Lcls_retstruct1b
cmpl    $FFI_TYPE_SMALL_STRUCT_2B, %eax
je      .Lcls_retstruct2b
cmpl    $FFI_TYPE_STRUCT, %eax
je      .Lcls_retstruct</pre>

<p>.Lcls_epilogue:</p>

<pre>movl    %ebp, %esp
popl    %ebp
ret</pre>

<p>.Lcls_retint:</p>

<pre>movl    (%ecx), %eax
jmp     .Lcls_epilogue</pre>

<p>.Lcls_retfloat:</p>

<pre>flds    (%ecx)
jmp     .Lcls_epilogue</pre>

<p>.Lcls_retdouble:</p>

<pre>fldl    (%ecx)
jmp     .Lcls_epilogue</pre>

<p>.Lcls_retldouble:</p>

<pre>fldt    (%ecx)
jmp     .Lcls_epilogue</pre>

<p>.Lcls_retllong:</p>

<pre>movl    (%ecx), %eax
movl    4(%ecx), %edx
jmp     .Lcls_epilogue</pre>

<p>.Lcls_retstruct1b:</p>

<pre>movsbl  (%ecx), %eax
jmp     .Lcls_epilogue</pre>

<p>.Lcls_retstruct2b:</p>

<pre>movswl  (%ecx), %eax
jmp     .Lcls_epilogue</pre>

<p>.Lcls_retstruct:</p>

<pre>lea -8(%ebp),%esp
movl    %ebp, %esp
popl    %ebp
ret $4</pre>

<p>.LFE2:</p>

<p>if !FFI_NO_RAW_API</p>

<p>define RAW_CLOSURE_CIF_OFFSET ((FFI_TRAMPOLINE_SIZE + 3) &amp; ~3) define
RAW_CLOSURE_FUN_OFFSET (RAW_CLOSURE_CIF_OFFSET + 4) define
RAW_CLOSURE_USER_DATA_OFFSET (RAW_CLOSURE_FUN_OFFSET + 4) define
CIF_FLAGS_OFFSET 20</p>

<pre>.align  4</pre>

<p>FFI_HIDDEN (ffi_closure_raw_SYSV) .globl _ffi_closure_raw_SYSV</p>

<p>_ffi_closure_raw_SYSV: .LFB3:</p>

<pre>pushl   %ebp</pre>

<p>.LCFI4:</p>

<pre>movl    %esp, %ebp</pre>

<p>.LCFI5:</p>

<pre>pushl   %esi</pre>

<p>.LCFI6:</p>

<pre>subl    $36, %esp
movl    RAW_CLOSURE_CIF_OFFSET(%eax), %esi       /* closure-&gt;cif */
movl    RAW_CLOSURE_USER_DATA_OFFSET(%eax), %edx /* closure-&gt;user_data */
movl    %edx, 12(%esp)  /* user_data */
leal    8(%ebp), %edx   /* __builtin_dwarf_cfa () */
movl    %edx, 8(%esp)   /* raw_args */
leal    -24(%ebp), %edx
movl    %edx, 4(%esp)   /* &amp;res */
movl    %esi, (%esp)    /* cif */
call    *RAW_CLOSURE_FUN_OFFSET(%eax)            /* closure-&gt;fun */
movl    CIF_FLAGS_OFFSET(%esi), %eax             /* rtype */
cmpl    $FFI_TYPE_INT, %eax
je      .Lrcls_retint

/* Handle FFI_TYPE_UINT8, FFI_TYPE_SINT8, FFI_TYPE_UINT16,
   FFI_TYPE_SINT16, FFI_TYPE_UINT32, FFI_TYPE_SINT32.  */
cmpl    $FFI_TYPE_UINT64, %eax
jge     0f
cmpl    $FFI_TYPE_UINT8, %eax
jge     .Lrcls_retint</pre>

<p>0:</p>

<pre>cmpl    $FFI_TYPE_FLOAT, %eax
je      .Lrcls_retfloat
cmpl    $FFI_TYPE_DOUBLE, %eax
je      .Lrcls_retdouble
cmpl    $FFI_TYPE_LONGDOUBLE, %eax
je      .Lrcls_retldouble
cmpl    $FFI_TYPE_SINT64, %eax
je      .Lrcls_retllong</pre>

<p>.Lrcls_epilogue:</p>

<pre>addl    $36, %esp
popl    %esi
popl    %ebp
ret</pre>

<p>.Lrcls_retint:</p>

<pre>movl    -24(%ebp), %eax
jmp     .Lrcls_epilogue</pre>

<p>.Lrcls_retfloat:</p>

<pre>flds    -24(%ebp)
jmp     .Lrcls_epilogue</pre>

<p>.Lrcls_retdouble:</p>

<pre>fldl    -24(%ebp)
jmp     .Lrcls_epilogue</pre>

<p>.Lrcls_retldouble:</p>

<pre>fldt    -24(%ebp)
jmp     .Lrcls_epilogue</pre>

<p>.Lrcls_retllong:</p>

<pre>movl    -24(%ebp), %eax
movl    -20(%ebp), %edx
jmp     .Lrcls_epilogue</pre>

<p>.LFE3: endif</p>

<p>.section
__IMPORT,__jump_table,symbol_stubs,self_modifying_code+pure_instructions,5
L_ffi_closure_SYSV_inner$stub:</p>

<pre>.indirect_symbol _ffi_closure_SYSV_inner
hlt ; hlt ; hlt ; hlt ; hlt</pre>

<p>.section __TEXT,__eh_frame,coalesced,no_toc+strip_static_syms+live_support
EH_frame1:</p>

<pre>.set    L$set$0,LECIE1-LSCIE1
.long   L$set$0</pre>

<p>LSCIE1:</p>

<pre>.long   0x0
.byte   0x1
.ascii &quot;zR\0&quot;
.byte   0x1
.byte   0x7c
.byte   0x8
.byte   0x1
.byte   0x10
.byte   0xc
.byte   0x5
.byte   0x4
.byte   0x88
.byte   0x1
.align 2</pre>

<p>LECIE1: .globl _ffi_call_SYSV.eh _ffi_call_SYSV.eh: LSFDE1:</p>

<pre>.set    L$set$1,LEFDE1-LASFDE1
.long   L$set$1</pre>

<p>LASFDE1:</p>

<pre>.long   LASFDE1-EH_frame1
.long   .LFB1-.
.set L$set$2,.LFE1-.LFB1
.long L$set$2
.byte   0x0
.byte   0x4
.set L$set$3,.LCFI0-.LFB1
.long L$set$3
.byte   0xe
.byte   0x8
.byte   0x84
.byte   0x2
.byte   0x4
.set L$set$4,.LCFI1-.LCFI0
.long L$set$4
.byte   0xd
.byte   0x4
.align 2</pre>

<p>LEFDE1: .globl _ffi_closure_SYSV.eh _ffi_closure_SYSV.eh: LSFDE2:</p>

<pre>.set    L$set$5,LEFDE2-LASFDE2
.long   L$set$5</pre>

<p>LASFDE2:</p>

<pre>.long   LASFDE2-EH_frame1
.long   .LFB2-.
.set L$set$6,.LFE2-.LFB2
.long L$set$6
.byte   0x0
.byte   0x4
.set L$set$7,.LCFI2-.LFB2
.long L$set$7
.byte   0xe
.byte   0x8
.byte   0x84
.byte   0x2
.byte   0x4
.set L$set$8,.LCFI3-.LCFI2
.long L$set$8
.byte   0xd
.byte   0x4
.align 2</pre>

<p>LEFDE2:</p>

<p>if !FFI_NO_RAW_API</p>

<p>.globl _ffi_closure_raw_SYSV.eh _ffi_closure_raw_SYSV.eh: LSFDE3:</p>

<pre>.set    L$set$10,LEFDE3-LASFDE3
.long   L$set$10</pre>

<p>LASFDE3:</p>

<pre>.long   LASFDE3-EH_frame1
.long   .LFB3-.
.set L$set$11,.LFE3-.LFB3
.long L$set$11
.byte   0x0
.byte   0x4
.set L$set$12,.LCFI4-.LFB3
.long L$set$12
.byte   0xe
.byte   0x8
.byte   0x84
.byte   0x2
.byte   0x4
.set L$set$13,.LCFI5-.LCFI4
.long L$set$13
.byte   0xd
.byte   0x4
.byte   0x4
.set L$set$14,.LCFI6-.LCFI5
.long L$set$14
.byte   0x85
.byte   0x3
.align 2</pre>

<p>LEFDE3:</p>

<p>endif</p>

<p>endif /* ifndef <em>x86_64</em> */</p>

</div>



<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 4.0.0.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

